"use strict";document.addEventListener("DOMContentLoaded",function(){var t={lastName:{presence:!0,length:{minimum:3,message:"должна содержать не менее 3 символов"}},firstName:{presence:!0,length:{minimum:3,message:"должно содержать не менее 3 символов"}},phoneNumber:{presence:!0,format:{pattern:/^\d{10}$/,message:"должен содержать 10 цифр"}},email:{presence:!0,email:{message:"не является корректным адресом электронной почты"}}},e=document.getElementById("feedbackFormScreen"),a=document.getElementById("submitForm"),m=["lastName","firstName","phoneNumber","email"];function n(){var n,e={lastName:document.getElementById("lastName").value,firstName:document.getElementById("firstName").value,phoneNumber:document.getElementById("phoneNumber").value,email:document.getElementById("email").value},e=validate(e,t);n=e,m.forEach(function(e){var t=document.getElementById(e+"Error");n&&n[e]?t.textContent=n[e][0]:t.textContent=""}),e?a.setAttribute("disabled","disabled"):a.removeAttribute("disabled")}m.forEach(function(e){document.getElementById(e).addEventListener("input",n)}),e.addEventListener("submit",function(e){e.preventDefault();n();e={lastName:document.getElementById("lastName").value,firstName:document.getElementById("firstName").value,middleName:document.getElementById("middleName").value,phoneNumber:document.getElementById("phoneNumber").value,email:document.getElementById("email").value,loanAmount:document.getElementById("loanAmount").value,initialPayment:document.getElementById("initialPayment").value,interestRate:document.getElementById("interestRate").value,loanTerm:document.getElementById("loanTerm").value,monthlyPayment:document.getElementById("monthlyPaymentResult").innerText};fetch("http://localhost/request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){if(e.ok)return e.json();throw new Error("Ошибка сети или сервера")}).then(function(e){e.success?alert("Данные успешно отправлены!"):alert("Произошла ошибка при отправке данных!")}).catch(function(e){console.error("Ошибка:",e),alert("Произошла ошибка при отправке данных!")})}),document.getElementById("toFeedbackFormButton").addEventListener("click",function(){document.getElementById("calculatorScreen").classList.add("hidden"),document.getElementById("feedbackFormScreen").classList.remove("hidden")}),document.getElementById("backToCalculator").addEventListener("click",function(e){e.preventDefault(),document.getElementById("feedbackFormScreen").classList.add("hidden"),document.getElementById("calculatorScreen").classList.remove("hidden")})}),document.addEventListener("DOMContentLoaded",function(){document.getElementById("feedbackFormScreen").classList.add("hidden"),document.getElementById("calculateButton").addEventListener("click",function(){a=parseFloat(document.getElementById("loanAmount").value),e=parseFloat(document.getElementById("initialPayment").value),t=parseFloat(document.getElementById("interestRate").value)/100/12,n=12*parseInt(document.getElementById("loanTerm").value);var e,t,n,a=(a-e)*Math.pow(1+t,n)*t/(Math.pow(1+t,n)-1);document.getElementById("monthlyPaymentResult").innerText="".concat(a.toFixed(2)," ₽"),document.getElementById("toFeedbackFormButton").removeAttribute("disabled"),localStorage.setItem("loanAmount",document.getElementById("loanAmount").value),localStorage.setItem("initialPayment",document.getElementById("initialPayment").value),localStorage.setItem("interestRate",document.getElementById("interestRate").value),localStorage.setItem("loanTerm",document.getElementById("loanTerm").value)});["loanAmount","initialPayment","interestRate","loanTerm","monthlyPaymentResult"].forEach(function(e){var t=document.getElementById(e),n=localStorage.getItem(e);null!==n&&t&&(t.value=n),t&&t.addEventListener("change",function(){localStorage.setItem(e,this.value)})}),document.getElementById("toFeedbackFormButton").addEventListener("click",function(){document.getElementById("calculatorScreen").classList.add("hidden"),document.getElementById("feedbackFormScreen").classList.remove("hidden")}),document.getElementById("backToCalculator").addEventListener("click",function(){document.getElementById("feedbackFormScreen").classList.add("hidden"),document.getElementById("calculatorScreen").classList.remove("hidden")})});